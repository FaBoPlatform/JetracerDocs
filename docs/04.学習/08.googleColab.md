# Google Colaboratoryを使った学習(工事中)

## AI86 Version 2.0.0

Jetson Nanoだけでもエッジでの学習はできますが、インターネット環境があればクラウドでも学習はできます。

Google Colaboratory(Google Colab)を使用することでGPUなどのハードウェアなしで使うことができます。
Jupyter NoteBookは初めから用意されており、学習時間を短縮、画像枚数もより多く扱うことが容易になります。
（※ただし、無料でのご使用の場合は、使用時間の制限を受けます。）

### データセットをzipファイルにする

収集したデータセットをクラウドへアップします。12_download_data.ipynbを開いて

一つのzipファイルにしてGoogle Colaboratoryアップできるようにします。

画像ファイル枚数によって終了時間が異なります。８番が出るまで待ちましょう。

### Googleのマイドライブへデータセットをアップロードする

作成したzipファイルは、zipフォルダにあります。ダウンロードしたいファイルを右クリックDownloadを選択します。

パソコンにダウンロードされます。

Google Colaboratoryを使用する前に、事前にGoogleアカウントが必要です。Googleにログインします。

事前に、Googleドライブ内にJetRacer_WorkSpeaceという名前の専用のフォルダを作りましょう。

### 学習や動画検証を実行するPythonコードをアップロード

マイドライブにJetRacerCloudBeta000.ipynbアップロードします。

データセットのファイルのパスは、"/content/drive/MyDrive/workspace_jetracer/dataset/・・・・・"

### データセットのファイルのパス

Googleのマイドライブではなく、ファイルGoogle Colaboratoryのディレクトリにアクセスの場合は、

"drive/MyDrive/workspace_jetracer/dataset/......."

モデルの出力先

"drive/MyDrive/workspace_jetracer/model/......."

ZipファイルをGoogleのマイドライブへアップロードします。

右クリックしてzipエクストラクタを使って、zipファイルを解凍します。

解凍が終了したのならGoogle Colaboratoryにアクセスします。

Google Colaboratoryにようこそ
https://colab.research.google.com/?hl=ja

ファイルをクリックし、ノートブックを開くを選択します。

Zipファイルをドラックアンドドロップかファイル選択してGoogle Colaboratoryへアップロードします。

Googleのマイドライブへアクセスするため、ユーザーの許可が必要となります。

GPUを有効にします。

lossが低くなるように任意のエポック数に変えて、学習させます。（無料でのご使用の場合は、時間制限があります。ご注意ください。）

学習（エポック）が終了したのなら、出来たモデルをGoogleドライブに保存します。

## 動画検証によるモデルの評価

出来たモデルの評価を撮影済みの画像を使って評価します。結果が芳しくなかった場合は、データセットを増やしたり、エポック数を増やして再び学習し調整します。

評価したいモデルのパス

評価に使う画像のパス

動画ファイルが生成され動画が映し出されます。青い丸が推論した座標になります。ダウンロード、再生速度が設定出来ます。

保存した学習済みモデルをダウンロードしてそのファイルをJetson Nanoのmodelディレクトリへアップロードします。

その後は、03_optimize_model.ipynbにてTensorRTにてモデルの最適化し、04_road_following.ipynbにて自動走行します。
